# RDS

- MySQL、PostgreSQL、MariaDB、Oracle、SQL Server、Auroraに対応。リードレプリカを5まで作成可能。デフォルトで自動バックアップが設定されている。
    - 暗号化
        - 暗号化を行う場合は、DB作成時に指定し、作成後に暗号化は不可能。また、暗号化を解除する方法もない。

## RDS Proxy

- RDSやAuroraへの接続を効率的に管理するフルマネージドのプロキシサービス。アプリケーションとDBの間に配置することで、DB接続の管理を効率化、アプリケーションのパフォーマンス、スケーラビリティ、可用性を向上させられる。

## マルチAZ

- プライマリインスタンスとスタンバイインスタンスを2つの異なるAZに1つずつ配置することによって可用性を向上させることができる。
- DBクラスター
    - マルチAZ構成の新しい高可用性オプション。3つのAZのまたがって配置される。
    - 2つのスタンバイインスタンスがリードレプリカとしても機能し、読み取りアクセスが可能。プライマリーインスタンスへの書き込みは、残り2台のリードレプリカに準同期レプリケーションされる。
    - フェイルオーバー時には通常35秒未満で切り替わる。

# RDS vs Aurora

## マルチAZ

### RDS

- セカンダリインスタンス
    - 書き込み不可
    - 読み取り不可
        
        ホットスタンバイ専用
        
    - 自動フェイルオーバー
- リードレプリカ
    - 読み取り専用
    - 自動昇格なし（手動のみ）
    - 非同期レプリケーション

### Aurora

- 1つのWriterと複数のReaderが3つのAZに分散
- Writerは読み書き可能・Readerは読み取り専用
- Writerに障害が起きたら自動でReaderが昇格

### クロスリージョン

### RDS

- クロスリージョンリードレプリカ
    - 自動昇格なし（手動のみ）
    - RPO…数十秒〜数分
    - 同期方法
        - 非同期の論理レプリケーション（SQLベース）
            - 対応DB
                - MySQL
                - PostgreSQL
                - MariaDB
                - Oracle
            - SQLステートメント/WAS（PstgreSQL）などの論理ログ
            - 非同期
            - トランザクション単位（INSERT/UPDATE/DELETE）
            - 経路
                - VPCピアリング
                - AWSネットワーク
            - レプリカに若干の遅延あり（30〜数分）

### Aurora

- グローバルデータベース
    - 書き込み❌
    - 読み取り✅
    - RPO…1秒未満（を目指して設計）
    - 自動フェイルオーバー
    - 同期方法
        - 非同期の物理レプリケーション（storage-based）
            - Auroraが管理しているため、DBエンジンに依存しない
            - 低レイテンシでの複製（通常1秒未満）
            - 高速フェイルオーバー（セカンダリ昇格：数分）