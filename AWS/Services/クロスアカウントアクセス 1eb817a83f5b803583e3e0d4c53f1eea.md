# クロスアカウントアクセス

### 前提

アカウントA：アクセスされるリソース等を保持

アカウントB：アクセスする側

### 1. アクセス先で受け渡すIAMロールを用意する

リソースへのアクセス許可を設定したIAMロールを作成する。

ここで定義したARNをアカウントB側に共有する必要あり。

### 2. 信頼ポリシーを設定する

アクセスを許可するアカウントIDを指定する **信頼ポリシー**を設定する。

外部ID( `ExternalId`)を設定することで、アクセスする際のセキュリティを強化できる。別組織や第3者企業などにアクセスを許可する際には使用が推奨される。

### 3. `sts:AssumeRole` を使ってロールを引き受ける（アカウントB）

STSを使ってIAMロールを引き受ける。

必須：IAMロールのARN

オプション：外部ID

```bash
aws sts assume-role \
--role-arn arn:aws:iam::<AccountA>:role/CrossAccountAccessRole \
--role-session-name exampleSession \
--external-id your-external-id
```

- アクセス側に外部IDを要求することで、ARNが漏れてもロールを受け取れずセキュリティリスクを回避できる。